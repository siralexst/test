<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="theme-color" content="#0b1020"/>
  <link rel="manifest" href="./manifest.json"/>
  <link rel="apple-touch-icon" href="icons/icon-192.png"/>
  <title>Agenti PWA • Futurist</title>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            bg: '#0b1020',
            panel: '#121830',
            neon: '#00e5ff',
            bur: '#7a1632'
          }
        }
      }
    }
  </script>

  <!-- LocalForage (offline queue) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>
  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <link rel="stylesheet" href="./style.css"/>
</head>
<body class="bg-bg text-slate-100 selection:bg-neon/30 selection:text-white">
  <header class="sticky top-0 z-50 border-b border-white/10 backdrop-blur bg-bg/80">
    <div class="px-4 py-3">
      <h1 class="text-[20px] font-semibold tracking-tight">
        Agenti <span class="text-neon">PWA</span> <span class="text-bur">•</span> Futurist
      </h1>
      <p class="text-xs opacity-70">Colectare prețuri • Comparativ • Simulator</p>
    </div>
    <nav class="grid grid-cols-3 text-center text-sm">
      <button class="tab-btn py-3 border-b-2 border-neon text-neon" data-tab="tab1">Colectare</button>
      <button class="tab-btn py-3 border-b-2 border-transparent" data-tab="tab2">Comparativ</button>
      <button class="tab-btn py-3 border-b-2 border-transparent" data-tab="tab3">Simulator</button>
    </nav>
  </header>

  <main class="p-4 space-y-8">

    <!-- TAB 1 -->
    <section id="tab1" class="tab active space-y-6">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold">Progres competitori</h2>
        <button id="refresh-cards" class="btn ghost text-xs">Reîncarcă</button>
      </div>
      <div id="competitor-cards" class="grid grid-cols-2 gap-3"></div>

      <div class="card">
        <h3 class="font-semibold mb-3">Adaugă preț (claim unic)</h3>
        <div class="grid gap-3">
          <select id="produs-select" class="input tap"></select>
          <select id="competitor-select" class="input tap"></select>
          <input id="price-input" inputmode="decimal" type="number" step="0.01" min="0" placeholder="Preț (lei)" class="input tap text-[18px] py-3">
          <input id="agent-input" type="text" placeholder="Nume agent (opțional)" class="input tap">
          <button id="add-price-btn" class="btn primary">Adaugă</button>
          <p id="collect-msg" class="text-xs opacity-80"></p>
        </div>
      </div>
    </section>

    <!-- TAB 2 -->
    <section id="tab2" class="tab hidden space-y-4">
      <div class="flex gap-2">
        <input id="search-input" class="input flex-1 tap" placeholder="Caută produs… ex: Ariel"/>
        <button id="reload-compare" class="btn ghost">Reîncarcă</button>
      </div>

      <div class="card overflow-hidden">
        <div class="sticky top-[88px] z-10 bg-panel/80 backdrop-blur border-b border-white/10">
          <div class="grid grid-cols-6 text-[12px] font-semibold px-3 py-2">
            <div>Produs</div><div>Preț nostru</div><div>Competitor</div><div>Preț</div><div>Dif (lei)</div><div>Dif (%)</div>
          </div>
        </div>
        <div id="compare-rows" class="divide-y divide-white/5"></div>
      </div>
    </section>

    <!-- TAB 3 -->
    <section id="tab3" class="tab hidden space-y-4">
      <div class="card grid gap-3">
        <select id="sim-product" class="input tap"></select>
        <input id="sim-qty" type="number" min="1" value="1" class="input tap text-[18px] py-3" placeholder="Cantitate"/>
        <button id="sim-add" class="btn primary">Adaugă în coș</button>
      </div>

      <div class="card overflow-hidden">
        <div class="grid grid-cols-8 text-[12px] font-semibold px-3 py-2 bg-panel/80 border-b border-white/10">
          <div>Produs</div><div>Preț nostru</div><div>Best comp.</div><div>Preț comp.</div><div>Dif (lei)</div><div>Dif (%)</div><div>Cant.</div><div></div>
        </div>
        <div id="sim-rows" class="divide-y divide-white/5"></div>
      </div>

      <div class="card flex items-center justify-between">
        <div>
          <div class="text-xs opacity-70">Total coș (noi)</div>
          <div id="sim-total" class="text-lg font-semibold">0.00 lei</div>
        </div>
        <div class="text-right">
          <div class="text-xs opacity-70">Discount necesar pt. competitivitate</div>
          <div id="sim-discount" class="text-lg font-semibold">0%</div>
        </div>
      </div>
    </section>

  </main>

  <script type="module" src="./app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('./service-worker.js'));
    }
  </script>
</body>
</html>
